<!DOCTYPE html>
<html>
<head>
<title>SVG to PNG Image Converter</title>
<style>
#drop {
	border:15px solid rgba(128,0,128,0.5);
	margin-bottom:20px;
	padding:10px;
}
#drop-2 {
	border:5px dotted rgba(128,0,255,0.7);
	margin-bottom:20px;
	padding:10px;
}
</style>

</head>
<body>
	<h1>Drag and Drop SVG to PNG Conversion</h1>
	<p>Drop any SVG and get a PNG image download all on the client side. <br><a style="font-size:8px; font-family: sans-serif; color: rgba(0,0,200,0.8)" href="http://techslides.com/save-svg-as-an-image/">Source.</a></p>
<div id="drop">
	DROP!<button onclick="document.querySelector('input').click()">Or Select</button>
	<input style="visibility: collapse; width: 0px;" type="file" onchange="upload(this.files[0])">
</div>



<canvas id="canvas" style="display:none"></canvas>
<img id="image" style="clear:both;display:none;">

<script type="text/javascript">

var v = document.getElementById("image");

    /* Drag drop stuff */
    window.ondragover = function(e) {e.preventDefault()}
    window.ondrop = function(e) {
	    e.preventDefault();
	    console.log("Reading...");
	    var length = e.dataTransfer.items.length;
	    if(length > 1){
	    	console.log("Please only drop 1 file.");
	    } else {
	    	upload(e.dataTransfer.files[0]);
	    }
	}

    /* main upload function */
    function upload(file) {
    	if(file.type.match(/image\/*/)){
	    	oFReader = new FileReader();
	        oFReader.onloadend = function() {

	        	var blob = new Blob([this.result], {type: file.type});
	        	var url = URL.createObjectURL(blob);

				var image = new Image;
				image.src = url;
				image.onload = function() {

					var canvas = document.querySelector("canvas");
					canvas.width = image.width;
					canvas.height = image.height;
					
					var context = canvas.getContext("2d");
								
				  context.drawImage(image, 0, 0);

				  var a = document.createElement("a");
				  a.download = "image.png";
				  a.href = canvas.toDataURL("image/png");		  
				  a.click();

	        	  v = document.getElementById("image");
	        	  v.src = a.href
	        	  v.style.display = "block";


				};



	        };
	        oFReader.readAsArrayBuffer(file);
        } else {
        	console.log("This file does not seem to be an SVG image.");
        }
    }
</script>
</body>
</html>
